import os
from vosk import Model, KaldiRecognizer
import wave
import json

# Load Vosk model
model = Model("model")

# Path to the audio file
audio_path = "audio_extracted.wav"

# Read audio file
wf = wave.open(audio_path, "rb")
rec = KaldiRecognizer(model, wf.getframerate())

# Process audio and get transcription
transcription = []
while True:
    data = wf.readframes(4000)
    if len(data) == 0:
        break
    if rec.AcceptWaveform(data):
        result = rec.Result()
        transcription.append(json.loads(result)["text"])

# Finalize transcription
final_result = rec.FinalResult()
transcription.append(json.loads(final_result)["text"])

# Print the transcription
print(" ".join(transcription))
